node{
	//We are creating a variable as the groovy script do not know what mvn command is
	//So we have to give full path for mvn command.
	// tool name: will provide path till /var/lib/jenkins/tools/hudson.tasks.Maven_MavenInstallation
	def mavenHome = tool name: "Maven3.9.12"

echo "The Job name is: ${env.JOB_NAME}"
echo "The Nod ename is: ${env.NODE_NAME}"
echo "The Build Number is: ${env.BUILD_NUMBER}"
echo "The Jenkins Home directory is: ${JENKINS_HOME}"
	
	//We can give any name in the quotes 
	stage('Checkout'){
		git branch: 'development', url: 'https://github.com/deebor-devops-tutorial/maven-web-application.git'
	}
	
	//Maven build project
	// sh for linux installed jenkins and bat for windows installed jenkins
	stage('build'){
		sh "$mavenHome/bin/mvn clean package"
	}
	
	//Generate sonar report
	stage('Sonar Report'){
		sh "$mavenHome/bin/mvn sonar:sonar"
	}
	
	//Upload to nexus
	stage('Upload to nexus'){
		sh "$mavenHome/bin/mvn deploy"
	}
	
	//deploy to tomcat
	stage('Deploy to tomcat'){
	    deploy adapters: [tomcat9(alternativeDeploymentContext: '', credentialsId: '3bf1f523-08e2-47ea-879c-2d2ce061a11b', path: '', url: 'http://172.31.175.241:8090/')], contextPath: null, war: '**/maven-web-application.war'
	}
}
